<html>
    <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">

      <title>Autocomplete Quick Test</title>
      <meta name="description" content="A quick test of my autocomplete API.">
      <meta name="author" content="Brady Hurlburt">

      <meta property="og:title" content="Autocomplete Quick Test">
      <meta property="og:type" content="website">
      <meta property="og:url" content="https://hbradio.github.io/autocomplete-quick-test">
      <meta property="og:description" content="A quick test of my autocomplete API.">
    </head>
    <body>
        <h1>Shakespeare Autocompleter</h1>

        <form>
            <input type="text" id="phrase" name="phrase" value="Hello, ">
        </form>

        <button onclick="myFunction()">autocomplete</button>

        <p id=result>Warming up. Wait just a moment.</p>
    </body>

    <script>
        // Warm up the lambda on page load
        fetch('https://nedk6qxpi5.execute-api.us-east-1.amazonaws.com/deployed/completion?type=shakespeare001&phrase=asdf')
            .then(response => response.json())
            .then(data => {
                console.log("warm!");
                document.getElementById("result").innerHTML = "Ready!";
            });

        function myFunction() {
            document.getElementById("result").innerHTML = "...";
            const phrase = document.getElementById("phrase").value;
            const uriPhrase = encodeURI(phrase);
            fetch('https://nedk6qxpi5.execute-api.us-east-1.amazonaws.com/deployed/completion?type=shakespeare001&phrase=' + uriPhrase)
                .then(response => response.json())
                .then(data => {
                    console.log(data);
                    document.getElementById("result").innerHTML = phrase + data.completion;
                });
        }

        document.getElementById("phrase").addEventListener("keyup", function(event) {
            // Number 13 is the "Enter" key on the keyboard
            if (event.keyCode === 13) {
                event.preventDefault();
                myFunction();
            }
        });
    </script>

    <style>
        body {
            font-size: 24px;
            max-width: 500px;
            margin: auto;
            margin-top: 100px;
        }

        button, input {
            font-size: 24px;
        }
    </style>
</html>
